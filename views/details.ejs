<!DOCTYPE html>
<html lang="en">
<%- include('./partials/head.ejs')%>
<body>
    <%- include('./partials/nav.ejs')%>
    <div class="details content">
        <h2><%= blog.title%></h2>
        <div class="content">
            <p><%= blog.body%></p>
        </div>
        <a class="delete" data-doc="<%= blog._id%>">Delete</a> 
        <!-- With the help of data attribute we can add our own custom attributes , here we have blog._id -->
    </div>

    <!-- we want to run the delete request on the browser and not on the server so we are implementing it inside html file only -->

    <script>
        const trashCan = document.querySelector('.delete')

        trashCan.addEventListener('click',(e)=>{
            // e.preventDefault()
            const endPoint = `/blogs/${trashCan.dataset.doc}`

            fetch(endPoint,{
                method:'DELETE'
            })
            .then((response)=>
                response.json()
            ) //this response will return another json which we can process t
            .then((data)=>
                window.location.href=data.redirect
                //we have added redirect property to json and here we are using it so when we hit delete we are thrown back to the home page
            ).catch(err=>{
                console.log(err)
            })

        })
    </script>
    
</body>
</html>